b17_clear <- mask(bands17, cloudsmask, maskvalues = NULL)
b17_clear_proj <- project(b17_clear, moz_crs)
aoi_mine_area <- crop(b17_clear_proj, mine_area, snap = "near", mask = TRUE)
return(aoi_mine_area)
}
blma2021 <- aoi(blma2021_qa, blma2021_b17, syrah_buf)
aoi <- function(QA_band, bands_17, mine_area) {
cloudsmask <- classify(QA_band, rbind(c(21824, 21824), c(21952, 21952)), others = NULL)
b17_clear <- mask(bands17, cloudsmask, maskvalues = NULL, updatevalue = NULL)
b17_clear_proj <- project(b17_clear, moz_crs)
aoi_mine_area <- crop(b17_clear_proj, mine_area, snap = "near", mask = TRUE)
return(aoi_mine_area)
}
blma2021 <- aoi(blma2021_qa, blma2021_b17, syrah_buf)
aoi <- function(QA_band, bands_17, mine_area) {
cloudsmask <- classify(QA_band, rbind(c(21824, 21824), c(21952, 21952)), others = NULL)
b17_clear <- terra::mask(bands17, cloudsmask, maskvalues = NULL, updatevalue = NULL)
b17_clear_proj <- project(b17_clear, moz_crs)
aoi_mine_area <- crop(b17_clear_proj, mine_area, snap = "near", mask = TRUE)
return(aoi_mine_area)
}
blma2021 <- aoi(blma2021_qa, blma2021_b17, syrah_buf)
aoi <- function(QA_band, bands_17, mine_area) {
cloudsmask <- classify(QA_band, rbind(c(21824, 21824), c(21952, 21952)), others = NULL)
b17_clear <- terra:mask(bands17, cloudsmask, maskvalues = NULL, updatevalue = NULL)
b17_clear_proj <- project(b17_clear, moz_crs)
aoi_mine_area <- crop(b17_clear_proj, mine_area, snap = "near", mask = TRUE)
return(aoi_mine_area)
}
blma2021 <- aoi(blma2021_qa, blma2021_b17, syrah_buf)
aoi <- function(QA_band, bands_17, mine_area) {
cloudsmask <- terra::classify(QA_band, rbind(c(21824, 21824), c(21952, 21952)), others = NULL)
b17_clear <- terra::mask(bands17, cloudsmask, maskvalues = NULL, updatevalue = NULL)
b17_clear_proj <- project(b17_clear, moz_crs)
aoi_mine_area <- crop(b17_clear_proj, mine_area, snap = "near", mask = TRUE)
return(aoi_mine_area)
}
blma2021 <- aoi(blma2021_qa, blma2021_b17, syrah_buf)
bands17
aoi <- function(QA_band, bands_17, mine_area) {
cloudsmask <- terra::classify(QA_band, rbind(c(21824, 21824), c(21952, 21952)), others = NULL)
b17_clear <- terra::mask(bands_17, cloudsmask, maskvalues = NULL, updatevalue = NULL)
b17_clear_proj <- project(b17_clear, moz_crs)
aoi_mine_area <- crop(b17_clear_proj, mine_area, snap = "near", mask = TRUE)
return(aoi_mine_area)
}
blma2021 <- aoi(blma2021_qa, blma2021_b17, syrah_buf)
aoi <- function(QA_band, bands_17, mine_area) {
cloudsmask <- terra::classify(QA_band, rbind(c(21824, 21824), c(21952, 21952)), others = NULL)
b17_clear <- terra::mask(bands_17, cloudsmask)
b17_clear_proj <- project(b17_clear, moz_crs)
aoi_mine_area <- crop(b17_clear_proj, mine_area, snap = "near", mask = TRUE)
return(aoi_mine_area)
}
blma2021 <- aoi(blma2021_qa, blma2021_b17, syrah_buf)
names(blma2021) <- gsub(
pattern = "LC08_L2SP_165069_20210609_20210615_02_T1_SR",
replacement = "blma2021",
names(blma2021))
plot(blma2021$blma2021_B4)
plot(syrah, add = TRUE)
blma2021_b543 <- c(blma2021_b17[[5]], blma2021_b17[[4]], blma2021_b17[[3]])
plotRGB(blma2021_b543, r = 1, g = 2, b = 3, stretch = "lin")
blma2021_b543 <- c(blma2021[[5]], blma2021[[4]], blma2021[[3]])
plotRGB(blma2021_b543, r = 1, g = 2, b = 3, stretch = "lin")
plot(syrah, add = TRUE)
blma2021_b432 <- c(blma2021[[4]], blma2021[[3]], blma2021[[2]])
plotRGB(blma2021_b432, r = 1, g = 2, b = 3, stretch = "lin")
plot(syrah, add = TRUE)
blma2021_b654 <- c(blma2021[[6]], blma2021[[5]], blma2021[[4]])
plotRGB(blma2021_b654, r = 1, g = 2, b = 3, stretch = "lin")
plot(syrah, add = TRUE)
blma2021_b432
plot(blma2021_b432)
plotRGB(blma2021_b432)
plotRGB(blma2021_b432, r = 1, g = 2, b = 3, stretch = "lin")
plotRGB(blma2021_b654, r = 1, g = 2, b = 3, stretch = "lin")
plotRGB(blma2021_b543, r = 1, g = 2, b = 3, stretch = "lin")
blma2021_ndvi <- (blma2021[[5]]-blma2021[[4]])/(blma2021[[5]]+blma2021[[4]])
plotRGB(blma2021_ndvi, r = 1, g = 2, b = 3, stretch = "lin")
plotRGB(blma2021_ndvi)
plot(blma2021_ndvi)
Blma2021_ndbi <- (blma2021[[6]]-blma2021[[5]])/(blma2021[[6]]+blma2021[[5]])
plot(Blma2021_ndbi)
rm(Blma2021_ndbi)
blma2021_mndwi <- (blma2021[[3]]-blma2021[[6]])/(blma2021[[3]]+blma2021[[6]])
plot(Blma2021_ndbi)
blma2021_mndwi <- (blma2021[[3]]-blma2021[[6]])/(blma2021[[3]]+blma2021[[6]])
plot(blma2021_ndbi)
blma2021_ndbi <- (blma2021[[6]]-blma2021[[5]])/(blma2021[[6]]+blma2021[[5]])
plot(blma2021_ndbi)
blma2021_mndwi <- (blma2021[[3]]-blma2021[[6]])/(blma2021[[3]]+blma2021[[6]])
plot(blma2021_mndwi)
pairs(blma2021[[6:5]])
pairs(blma2021[[5:4]])
pairs(blma2021[[6:7]])
blma2021_ndvi
?writeRaster
blma2021_ndvi
aoi_index <- function(bands17, band_x, band_y) {
band_x <- bands17[[x]]
band_y <- bands17[[y]]
index <- (band_x - band_y)/(band_x + band_y)
return(index)
}
aoi_index <- function(bands_17, band_x, band_y) {
band_x <- bands17[[x]]
band_y <- bands17[[y]]
index <- (band_x - band_y)/(band_x + band_y)
return(index)
}
aoi_index(blma2021, 5, 4)
aoi_index <- function(bands_17, k, i) {
band_x <- bands17[[k]]
band_y <- bands17[[i]]
index <- (band_x - band_y)/(band_x + band_y)
return(index)
}
aoi_index(blma2021, 5, 4)
aoi_index <- function(bands_17, k, i) {
band_x <- bands_17[[k]]
band_y <- bands_17[[i]]
index <- (band_x - band_y)/(band_x + band_y)
return(index)
}
aoi_index(blma2021, 5, 4)
aoi_index <- function(bands_17, x, y) {
band_x <- bands_17[[x]]
band_y <- bands_17[[y]]
index <- (band_x - band_y)/(band_x + band_y)
return(index)
}
aoi_index(blma2021, 5, 4)
blma2021_ndvi
aoi_index <- function(bands_17, x, y) {
band_x <- bands_17[[x]]
band_y <- bands_17[[y]]
aoi_index <- (band_x - band_y)/(band_x + band_y)
aoi_index <- writeRaster(aoi_index, file.path("~/results/output", "aoi_index.tif"),
overwrite=TRUE, filetype="GTiff")
return(index)
}
aoi_index(blma2021, 5, 4)
aoi_index <- function(bands_17, x, y) {
band_x <- bands_17[[x]]
band_y <- bands_17[[y]]
aoi_index <- (band_x - band_y)/(band_x + band_y)
aoi_index <- writeRaster(aoi_index, file.path("~/results/output", "aoi_index.tif"),
overwrite=TRUE, filetype="GTiff")
return(aoi_index)
}
aoi_index(blma2021, 5, 4)
aoi_index <- function(bands_17, x, y) {
band_x <- bands_17[[x]]
band_y <- bands_17[[y]]
aoi_index <- (band_x - band_y)/(band_x + band_y)
aoi_index <- writeRaster(aoi_index, file.path("~/results/output", names(aoi_index)),
overwrite=TRUE, filetype="GTiff")
return(aoi_index)
}
aoi_index(blma2021, 5, 4)
aoi_index <- function(bands_17, x, y) {
band_x <- bands_17[[x]]
band_y <- bands_17[[y]]
aoi_index <- (band_x - band_y)/(band_x + band_y)
aoi_index <- writeRaster(aoi_index, file.path("~/results/output", aoi_index),
overwrite=TRUE, filetype="GTiff")
return(aoi_index)
}
aoi_index(blma2021, 5, 4)
?name
aoi_index <- function(bands_17, x, y) {
band_x <- bands_17[[x]]
band_y <- bands_17[[y]]
aoi_index <- (band_x - band_y)/(band_x + band_y)
aoi_index <- writeRaster(aoi_index, file.path("~/results/output", set.names(aoi_index)),
overwrite=TRUE, filetype="GTiff")
return(aoi_index)
}
aoi_index(blma2021, 5, 4)
blma2021_ndvi <- aoi_index(blma2021, 5, 4)
rm(aoi_index)
aoi_index <- function(bands_17, x, y) {
band_x <- bands_17[[x]]
band_y <- bands_17[[y]]
index <- (band_x - band_y)/(band_x + band_y)
return(index)
}
blma2021_ndvi <- aoi_index(blma2021, 5, 4)
blma2021_ndvi
writeRaster(blma2021_ndvi, file.path("~/results/output", "blma2021_ndvi.tif"),
overwrite=TRUE, filetype="GTiff")
blma2021_ndbi <- aoi_index(blma2021, 6, 5)
writeRaster(blma2021_ndbi, file.path("~/results/output", "blma2021_ndbi.tif"),
overwrite=TRUE, filetype="GTiff")
blma2021_mndwi <- aoi_index(blma2021, 3, 6)
writeRaster(blma2021_mndwi, file.path("~/results/output", "blma2021_mndwi.tif"),
overwrite=TRUE, filetype="GTiff")
plotRGB(blma2021_b543, r = 1, g = 2, b = 3, stretch = "lin")
plot(syrah, add = TRUE)
par(mfrow = c(2, 2))
plotRGB(blma2021_b543, r = 1, g = 2, b = 3, stretch = "lin")
plot(syrah, add = TRUE)
blma2021_b543
aoi_comps(blma2021, 5, 4, 3)
aoi_comps <- function(bands_17, x, y, z) {
aoi_comp <-c(bands_17[[x]], bands_17[[y]], bands_17[[z]])
return(aoi_comp)
}
aoi_comps(blma2021, 5, 4, 3)
writeRaster(blma2021_b543, file.path("~/results/output", "blma2021_b543.tif"),
overwrite=TRUE, filetype="GTiff")
blma2021_b654 <- aoi_comps(blma2021, 6, 5, 4)
writeRaster(blma2021_b654, file.path("~/results/output", "blma2021_b654.tif"),
overwrite=TRUE, filetype="GTiff")
blma2021_b432 <- aoi_comps(blma2021, 4, 3, 2)
writeRaster(blma2021_b432, file.path("~/results/output", "blma2021_b432.tif"),
overwrite=TRUE, filetype="GTiff")
plot(blma2021_ndvi)
plot(syrah, add = TRUE)
?predict
blma2021_train <- vect("~/data/temp/blma2021_b543_train.shp")
?vect
blma2021_train <- vect("~/data/temp/blma2021_b543_train.shp", layer = "blma2021_b543_train.shp") #start here
blma2021_train <- vect("~/data/temp/blma2021_b543_train.shp", package="terra") #start here
blma2021_train <- vect(x = "~/data/temp/blma2021_b543_train.shp", package="terra") #start here
blma2021_train <- vect(x = "~/data/temp/blma2021_b543_train.shp") #start here
system.file()
?system.file()
blma2021_train <- system.file("~/data/temp/blma2021_b543_train.shp", package = "terra")
blma2021_train_samps <- vect(blma2021_train)
rm(blma2021_train)
blma2021_train <- vect(x = "c:/Users/Namag001/cabo-delgado-environmental-change/data/temp/blma2021_b543_train.shp") #start
blma2021_train <- vect("c:/Users/Namag001/cabo-delgado-environmental-change/data/temp/blma2021_b543_train.shp") #start
blma2021_train <- vect("c:/Users/Namag001/cabo-delgado-environmental-change/data/temp/blma2021_b543_train-export.shp") #start
blma2021_train <- vect("~/data/temp/training-samples/blma2021_b543_train.shp")
rm(blma2021_train_samps)
plot(blma2021_train)
plot(syrah_buf, add=TRUE)
text(blma2021_train, blma2021_train$Classname)
rnorm(5)
rnorm(5)
set.seed(1)
rnorm(5)
rnorm(5)
rnorm(5)
rnorm(5)
set.seed(1)
rnorm(5)
rnorm(5)
rnorm(5)
set.seed(1)
blma2021_train_samps <- spatSample(blma2021_train, 200, method = "random")
plot(blma2021_train_samps)
blma2021_train
plot(blma2021_train_samps, "Classname")
?spatSample
table(as.character(blma2021_train_samps[,1]))
blma2021_train_samps
table(blma2021_train_samps[,1])
?table
blma2021_train_samps_df <- as.data.frame(blma2021_train_samps)
blma2021_train_samps_df
rm(blma2021_train_samps_df)
xy <- as.matrix(geom(blma2021_train_samps)[,c('x', 'y')])
df <- extract(blma2021_b543, xy) [,-1]
head(df)
table(blma2021_train_samps)
table(blma2021_train_samps$Count)
?spatSample
rm(df)
rm(xy)
dir.create("data", showWarnings = FALSE)
if (!file.exists("data/rs/samples.rds")) {
download.file("https://biogeo.ucdavis.edu/data/rspatial/rs.zip", dest = "data/rs.zip˓→")
unzip("data/rs.zip", exdir="data")
}
samp <- vect(readRDS('data/rs/lcsamples.rds'))
plot(blma2021_train_samps, "Classname")
rm(blma2021_train_samps)
?set.seed
blma2021_train_samps <- spatSample(blma2021_train, 200, method = "regular")
blma2021_train_samps_df <- extract(blma2021_b543, blma2021_train_samps)
head(blma2021_train_samps_df)
blma2021_train_samps_df_mean <- aggregate(blma2021_train_samps_df[, -1], list(blma2021_train_samps$Classname), mean)
rownames(blma2021_train_samps_df_mean) <- blma2021_train_samps_df_mean[, 1]
blma2021_train_samps_df_mean
rm(blma2021_train_samps_df_mean)
blma2021_train_samps_df_mean <- aggregate(blma2021_train_samps_df[, -1], list(blma2021_train_samps$Classname), mean)
blma2021_train_samps_df_mean
samp <- vect(readRDS("C:/Users/Namag001/OneDrive - Universiteit Utrecht/PhD/Spatial/Rfiles/ghosh_hijmans_training_rs/rs/lcsamples.rds"))
set.seed(555)
samp
plot(samp)
ptsamp <- spatSample(samp, 50, 'regular')
ptsamp
df <- extract(landsat, ptsamp)
filenames <- paste0("C:/Users/Namag001/OneDrive - Universiteit Utrecht/PhD/Spatial/Rfiles/ghosh_hijmans_training_rs/rs/LC08_044034_20170614_B", 1:11, ".tif")
filenames
landsat <- rast(filenames)
landsat
landsat <- subset(landsat, 1:7)
landsat
names(landsat) <- c('ultra-blue', 'blue', 'green', 'red', 'NIR', 'SWIR1', 'SWIR2')
df <- extract(landsat, ptsamp)
ptsamp
plot(ptsamp)
head(df)
?aggregate
ms <- aggregate(df[,-1], list(ptsamp$class), mean)
ms
rownames(ms) <- ms[,1]
ms
ms <- ms[,-1]
ms
blma2021_train_samps_df_mean
rownames(blma2021_train_samps_df_mean) <- blma2021_train_samps_df_mean[, 1]
blma2021_train_samps_df_mean
blma2021_train_samps_df_mean <- blma2021_train_samps_df_mean[, -1]
blma2021_train_samps_df_mean
?colors
demo("colors")
# Create a vector of color for the land cover classes for use in plotting
lulc_colors <- c('darkorange', 'darkgreen', 'green', 'blue', 'lightcyan')
rm(lulc_colors)
# Create a vector of color for the land cover classes for use in plotting
lulc_colors_5 <- c('darkorange', 'darkgreen', 'green', 'blue', 'lightcyan')
lulc_colors_4 <- c('darkorange', 'darkgreen', 'green', 'blue')
blma2021_train_samps_df_mean <- as.matrix(blma2021_train_samps_df_mean)
blma2021_train_samps_df_mean
?plot
# First create an empty plot
plot(7400, ylim=c(7400,18000), xlim = c(1,3), type='n', xlab="Bands", ylab = "Reflectance")
for (i in 1:nrow(blma2021_train_samps_df_mean)){
lines(blma2021_train_samps_df_mean[i,], type = "l", lwd = 3, lty = 1, col = lulc_colors_4[i])
}
title(main="Spectral Signatures", font.main = 2)
legend("topleft", rownames(blma2021_train_samps_df_mean),
cex=0.8, col=mycolor, lty = 1, lwd =3, bty = "n")
legend("topleft", rownames(blma2021_train_samps_df_mean),
cex=0.8, col=lulc_colors_4, lty = 1, lwd =3, bty = "n")
legend("topright", rownames(blma2021_train_samps_df_mean),
cex=0.8, col=lulc_colors_4, lty = 1, lwd =3, bty = "n")
plot(7400, ylim=c(7400,18000), xlim = c(1,3), type='n', xlab="Bands", ylab = "Reflectance")
for (i in 1:nrow(blma2021_train_samps_df_mean)){
lines(blma2021_train_samps_df_mean[i,], type = "l", lwd = 3, lty = 1, col = lulc_colors_4[i])
}
title(main="Spectral Signatures", font.main = 2)
legend("topright", rownames(blma2021_train_samps_df_mean),
cex=0.8, col=lulc_colors_4, lty = 1, lwd =3, bty = "n")
set.seed(1)
blma2021_samps <- spatSample(blma2021_train, 200, method = "random")
plot(blma2021_samps, "Classname")
plot(blma2021_b543)
plotRGB(blma2021_b543, r = 1, b = 2, g = 3, stretch = "lin")
points(blma2021_samps)
ptsamp
head(ptsamp)
xy <- as.matrix(geom(ptsamp)[,c('x','y')])
?geom
landsat
head(landsat)
df <- extract(landsat, xy)[,-1]
head(df)
blma2021_samps_xy <- as.matrix(geom(blma2021_samps)[,c('x','y')])
blma2021_samps_df <- extract(blma2021_b543, blma2021_samps_xy)
head(blma2021_samps_df)
blma2021_samps_final <- data.frame(class = blma2021_samps$Classname, blma2021_samps_df)
head(blma2021_samps_final)
blma2021_samps_final <- data.frame(class = blma2021_samps$Classname, blma2021_samps_df)
blma2021_samps_df
aggregate(blma2021_samps_df, list(blma2021_samps$Classname), mean)
aggregate(blma2021_samps_df, list(blma2021_samps$Classname), count)
?aggregate
aggregate(blma2021_samps_df, list(blma2021_samps$Classname), sum)
head(blma2021_samps)
table(as.character(blma2021_samps[,1]))
table(blma2021_samps[,1])
?table
table(blma2021_samps)
table(blma2021_samps_df)
table(blma2021_samps_df[,1])
table(blma2021_samps_xy[,1])
table(as.character(blma2021_samps[,1]))
blma2021_samps
table(as.character(blma2021_samps$Classname))
blma2021_samps <- spatSample(blma2021_train, 200, method = "random")
table(as.character(blma2021_samps$Classname))
blma2021_samps <- spatSample(blma2021_train, 500, method = "random")
table(as.character(blma2021_samps$Classname))
blma2021_samps_xy <- as.matrix(geom(blma2021_samps)[,c('x','y')])
blma2021_samps_df <- extract(blma2021_b543, blma2021_samps_xy)
blma2021_samps_final <- data.frame(class = blma2021_samps$Classname, blma2021_samps_df)
library(rpart) # train classification model
?rpart
blma2021_lulc_cart <- rpart(as.factor(Classname)~., data = blma2021_samps_final, method = 'class', minsplit = 5)
blma2021_lulc_cart <- rpart(as.factor(class)~., data = blma2021_samps_final, method = 'class', minsplit = 5)
print(blma2021_lulc_cart)
plot(blma2021_lulc_cart, uniform=TRUE, main="Classification Tree")
text(blma2021_lulc_cart, cex = 1)
blma2021_lulc_class <- predict(blma2021_b543, blma2021_lulc_cart, na.rm = TRUE)
blma2021_lulc_class
plot(blma2021_lulc_class)
blma2021_lulc <- which.max(blma2021_lulc_class)
plot(blma2021_lulc)
classes_4 <- c("built or bare", "dense vegetation", "sparse vegetation", "water")
classes_5 <- c("built or bare", "dense vegetation", "sparse vegetation", "water", "wetland")
lulc_df <- data.frame(id = 1:4, class = classes_4)
levels(blma2021_lulc) <- lulc_df
blma2021_lulc
plot(blma2021_lulc, lulc_colors_4)
print(blma2021_lulc_cart)
classes_4 <- c("built_bare", "dense_veg", "sparse_veg", "water")
classes_5 <- c("built_bare", "dense_veg", "sparse_veg", "water", "wetland")
lulc_df <- data.frame(id = 1:4, class = classes_4)
levels(blma2021_lulc) <- lulc_df
blma2021_lulc
plot(blma2021_lulc, lulc_colors_4)
blma2021_lulc
blma2021_lulc$class
blma2021_samps_final
classes_4 <- c("built_bare", "dense_veg", "sparse_veg", "water")
lulc_df <- data.frame(id = 1:4, class = classes_4)
levels(blma2021_lulc) <- lulc_df
blma2021_lulc
plot(blma2021_lulc, lulc_colors_4)
plot(blma2021_lulc, col = lulc_colors_4)
View(showCols1)
View(showCols1)
plot(showCols1)
showCols1()
lulc_colors_5 <- c('darkorange', 'darkgreen', 'green', 'deepskyblue', 'lightcyan')
lulc_colors_4 <- c('darkorange', 'darkgreen', 'green', 'deepskyblue')
plot(blma2021_lulc, col = lulc_colors_4)
lulc_colors_5 <- c('darkorange', 'darkgreen', 'green', 'dodgerblue', 'lightcyan')
lulc_colors_4 <- c('darkorange', 'darkgreen', 'green', 'dodgerblue')
plot(blma2021_lulc, col = lulc_colors_4)
library(dismo)
install.packages("dismo")
library(dismo)
j <- kfold(blma2021_samps_final, k = 5, by = blma2021_samps_final$class)
j
rm(j)
k <- 5
j <- sample(rep(1:k, each = round(nrow(blma2021_samps_final))/k))
j
set.seed(99)
rm(j)
rm(k)
j <- kfold(blma2021_samps_final, k = 5, by = blma2021_samps_final$class)
j
sampdata <- data.frame(class = ptsamp$class, df)
sampdata
blma2021_samps_final
set.seed(99)
k <- 5
j <- sample(rep(1:k, each = round(nrow(sampdata))/k))
table(j)
j <- kfold(blma2021_samps_final, k = 5, by = blma2021_samps_final$class)
table(j)
rm(k)
rm(j)
j <- kfold(blma2021_samps_final, k = 5, by = blma2021_samps_final$class)
table(j)
acc <- list()
for (k in 1:5) {
train <- blma2021_samps_final[j!= k, ]
test <- blma2021_samps_final[j == k, ]
cart <- rpart(as.factor(class)~., data=train, method = 'class', minsplit = 5)
pclass <- predict(cart, test, na.rm = TRUE)
pclass <- apply(pclass, 1, which.max)
x[[k]] <- cbind(test$class, as.integer(pclass))
}
for (k in 1:5) {
train <- blma2021_samps_final[j!= k, ]
test <- blma2021_samps_final[j == k, ]
cart <- rpart(as.factor(class)~., data=train, method = 'class', minsplit = 5)
pclass <- predict(cart, test, na.rm = TRUE)
pclass <- apply(pclass, 1, which.max)
acc[[k]] <- cbind(test$class, as.integer(pclass))
}
acc_5 <- do.call(rbind, acc)
acc_5 <- data.frame(acc_5)
colnames(acc_5) <- c('observed', 'predicted')
confmat <- table(acc_5)
print(confmat)
lulc_df
colnames(confmat) <- lulc_df$class
print(confmat)
sum(confmat)
diag(confmat)
sum(diag(confmat))/n
sum(diag(confmat))/sum(confmat)
blma2021_cases <- sum(confmat)
blma2021_true_cases <- diag(confmat)
blma2021_overall_acc <- sum(blma2021_true_cases)/blma2021_cases
blma2021_overall_acc
blma2021_rowsums <- apply(confmat, 1, sum)
blma2021_rowsums_class <- blma2021_rowsums/blma2021_cases
rm(blma2021_rowsums_class)
blma2021_rowsums_obs <- blma2021_rowsums/blma2021_cases
blma2021_colsums_prd <- apply(confmat, 2, sum)
rm(blma2021_colsums_prd)
blma2021_colsums <- apply(confmat, 2, sum)
blma2021_colsums_prd <- blma2021_colsums/blma2021_cases
blma2021_expAcc <- sum(blma2021_rowsums_obs*blma2021_colsums_prd)
blma2021_kappa <- (blma2021_overall_acc - blma2021_expAcc)/(1 - blma2021_expAcc)
blma2021_kappa
blma2021_ProdAcc <- blma2021_true_cases/blma2021_colsums
blma2021_UserAcc <- blma2021_true_cases/blma2021_rowsums
blma2021_outAcc <- data.frame(producerAccuracy = blma2021_ProdAcc, userAccuracy = blma2021_UserAcc)
blma2021_outAcc
